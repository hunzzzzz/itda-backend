<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.moira.itda.domain.common.image.mapper.CommonImageMapper">
    <!-- 이미지 업로드 > ImageFile 저장 -->
    <insert id="insertImageFile">
        INSERT INTO IMAGE_FILE (
               file_id
             , identifier
             , original_file_name
             , stored_file_name
             , size
             , file_url
             , created_at
        )
        VALUES (
               #{fileId}
             , #{identifier}
             , #{originalFileName}
             , #{storedFileName}
             , #{size}
             , #{fileUrl}
             , #{createdAt}
        )
    </insert>

    <!-- 이미지 목록 조회 -->
    <select id="selectImageFileUrl" resultType="com.moira.itda.domain.common.image.dto.response.FileUrlResponse">
        SELECT file_url FROM IMAGE_FILE WHERE file_id = #{fileId}
    </select>

    <!-- 파일 ID 존재 여부 확인 -->
    <select id="selectFileIdChk" resultType="java.lang.Boolean">
        SELECT EXISTS (
            SELECT 1 FROM IMAGE_FILE WHERE file_id = #{fileId}
        )
    </select>

    <!-- ImageFile 삭제 -->
    <delete id="deleteImageFile">
        DELETE FROM IMAGE_FILE WHERE file_id = #{fileId}
    </delete>
</mapper>