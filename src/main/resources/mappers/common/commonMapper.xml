<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.moira.itda.domain.common.mapper.CommonMapper">
    <!-- 공통 > 이미지 파일 업로드 > ImageFile 저장 -->
    <insert id="insertImageFile">
        INSERT INTO IMAGE_FILE (
               file_id
             , identifier
             , original_file_name
             , stored_file_name
             , size
             , file_url
             , created_at
        )
        VALUES (
               #{fileId}
             , #{identifier}
             , #{originalFileName}
             , #{storedFileName}
             , #{size}
             , #{fileUrl}
             , #{createdAt}
        )
    </insert>

    <!-- 공통 > 이미지 목록 조회 -->
    <select id="selectImageFileUrl" resultType="com.moira.itda.domain.common.dto.response.ImageFileUrlResponse">
        SELECT file_url FROM IMAGE_FILE WHERE file_id = #{fileId}
    </select>

    <select id="selectFileIdChk">
        SELECT COUNT(id) FROM IMAGE_FILE WHERE file_id = #{fileId}
    </select>

    <!-- 공통 > 공통코드 조회 > 세부코드 목록 조회 -->
    <select id="selectCodeDetailList" resultType="com.moira.itda.domain.common.dto.response.CodeDetailResponse">
        SELECT
               id AS detailId
             , eng_name
             , kor_name
        FROM COMMON_CODE_DETAIL
        WHERE code_key = #{key}
        ORDER BY created_at ASC
    </select>
</mapper>